const createCsvWriter = require('csv-writer').createObjectCsvWriter;  
var HeDate = require('./HeDate.min.js');
var moment = require('moment');

var dateStart=new HeDate(5778,1,1);
var dateEnd=new HeDate(5798,13,29);

const csvWriter = createCsvWriter({  
  path: 'calendar.csv',
  header: [
    {id: 'date', title: 'תאריך לועזי'},
    {id: 'heDate', title: 'תאריך עברי'},
    {id: 'event', title: 'אירועים'},
    {id: 'omer', title: 'ספירת העומר'},
  ],
  encoding: "UTF8"
});

const data = [];


while (dateStart.getTime()<=dateEnd.getTime()){
	data.push(  {
		date: moment(dateStart.ConvertToGregorian()).format("DD/MM/YYYY"),
		heDate: HeDate.gimatria(dateStart.getDate()) + " "+dateStart.getMonthString()+" "+HeDate.gimatria(dateStart.getYear()),
    event: getJwishHoliday(dateStart),
    omer: omer(dateStart,1)
	  })
	dateStart.setDate(dateStart.getDate()+1);
}

csvWriter  
  .writeRecords(data)
  .then(()=> console.log('The CSV file was written successfully'));


function getJwishHoliday(e){switch(e.getMonth()){case 1:if(e.getDate()==1||e.getDate()==2)return"ראש השנה";else if(e.getDate()==3&&e.getDay()!=7)return"צום גדליה";else if(e.getDate()==4&&e.getDay()==1)return"צום גדליה (נדחה)";else if(e.getDate()==9)return"ערב יום כיפור";else if(e.getDate()==10)return"יום כיפור";else if(e.getDate()==14)return"ערב סוכות";else if(e.getDate()==15)return"סוכות";else if(e.getDate()==16)return"א' חוה\"מ";else if(e.getDate()==17)return"ב' חוה\"מ";else if(e.getDate()==18)return"ג' חוה\"מ";else if(e.getDate()==19)return"ד' חוה\"מ";else if(e.getDate()==20)return"ה' חוה\"מ";else if(e.getDate()==21)return"הושענא רבה";else if(e.getDate()==22)return"שמיני עצרת ושמחת תורה";break;case 2:break;case 3:if(e.getDate()==24)return"ערב חנוכה";else if(e.getDate()==25)return"א' חנוכה";else if(e.getDate()==26)return"ב' חנוכה";else if(e.getDate()==27)return"ג' חנוכה";else if(e.getDate()==28)return"ד' חנוכה";else if(e.getDate()==29)return"ה' חנוכה";else if(e.getDate()==30)return"ו' חנוכה";break;case 4:if(e.getDate()<=3){var t=0;if(HeDate.getyeartype(e.getYear())==-1)t=1;if(e.getDate()==0+t)return"ו' חנוכה";else if(e.getDate()==1+t)return"ז' חנוכה";else if(e.getDate()==2+t)return"זאת חנוכה"}else if(e.getDate()==10)return"צום עשרה בטבת";break;case 5:if(e.getDate()==15)return"ראש השנה לאילנות";break;case 6:break;case 7:if(e.getDate()==11&&e.getDay()==5||e.getDate()==13&&e.getDay()!=7)return"תענית אסתר";else if(e.getDate()==14)return"פורים";else if(e.getDate()==15)return"שושן פורים";break;case 8:if(e.getDate()==14)return"ערב פסח";else if(e.getDate()==15)return"פסח";else if(e.getDate()==16)return"א' חוה\"מ";else if(e.getDate()==17)return"ב' חוה\"מ";else if(e.getDate()==18)return"ג' חוה\"מ";else if(e.getDate()==19)return"ד' חוה\"מ";else if(e.getDate()==20)return"ה' חוה\"מ";else if(e.getDate()==21)return"שביעי של פסח";if(e.getYear()>=5711){if(e.getDate()==26&&e.getDay()==5)return"יום הזיכרון לשואה ולגבורה (מוקדם)";else if(e.getDate()==28&&e.getDay()==2&&e.getYear()>=5757)return"יום הזיכרון לשואה ולגבורה (נדחה)";else if(e.getDate()==27&&e.getDay()!=6&&e.getDay()!=1|e.getYear()<5757)return"יום הזיכרון לשואה ולגבורה"}break;case 9:if(e.getYear()==5708&&e.getDate()<=6){if(e.getDate()==5)return"יום העצמאות";if(e.getDate()==4)return"יום הזיכרון לחללי מערכות ישראל"}if(e.getYear()>=5709&&e.getDate()<=6){if(e.getDate()==5&&e.getDay()==4)return"יום העצמאות";if(e.getYear()<5714){if(e.getDate()==6&&e.getDay()==1)return"יום העצמאות (נדחה)"}else{if(e.getDate()==3&&e.getDay()==5)return"יום העצמאות (הוקדם)"}if(e.getDate()==4&&e.getDay()==5)return"יום העצמאות (הוקדם)";if(e.getYear()<5764){if(e.getDate()==5&&e.getDay()==2)return"יום העצמאות"}else{if(e.getDate()==6&&e.getDay()==3)return"יום העצמאות (נדחה)"}if(e.getDate()==4&&e.getDay()==3)return"יום הזיכרון לחללי מערכות ישראל";if(e.getYear()<5714){if(e.getDate()==4&&e.getDay()==5)return"יום הזיכרון לחללי מערכות ישראל (הוקדם)"}else{if(e.getDate()==2&&e.getDay()==4)return"יום הזיכרון לחללי מערכות ישראל (הוקדם)"}if(e.getDate()==3&&e.getDay()==4)return"יום הזיכרון לחללי מערכות ישראל (הוקדם)";if(e.getYear()<5764){if(e.getDate()==4&&e.getDay()==1)return"יום הזיכרון לחללי מערכות ישראל"}else{if(e.getDate()==5&&e.getDay()==2)return"יום הזיכרון לחללי מערכות ישראל (נדחה)"}}else if(e.getDate()==18)return'ל"ג בעומר';else if(e.getDate()==28)return"יום ירושלים";break;case 10:if(e.getDate()==5)return"ערב שבועות";else if(e.getDate()==6)return"שבועות";break;case 11:if(e.getDate()==17&&e.getDay()!=7)return'צום י"ז בתמוז';else if(e.getDate()==18&&e.getDay()==1)return'צום י"ז בתמוז (נדחה)';break;case 12:if(e.getDate()==9&&e.getDay()!=7)return"צום ט' באב";if(e.getDate()==10&&e.getDay()==1)return"צום ט' באב (נדחה)";else if(e.getDate()==15)return'ט"ו באב';break;case 13:if(e.getDate()==29)return"ערב ראש השנה";break}return null}
function omer(e,r){var n=e.getTime()-new HeDate(e.getYear(),8,15).getTime();if(n>=1&&49>=n){if(0==r)return n;var t=new Array(50);return t[1]="היום יום אחד לעומר",t[2]="היום שני ימים לעומר",t[3]="היום שלושה ימים לעומר",t[4]="היום ארבעה ימים לעומר",t[5]="היום חמישה ימים לעומר",t[6]="היום שישה ימים לעומר",t[7]="היום שיבעה ימים לעומר, שהם שבוע אחד",t[8]="היום שמונה ימים לעומר, שהם שבוע אחד ויום אחד",t[9]="היום תישעה ימים לעומר, שהם שבוע אחד ושני ימים",t[10]="היום עשרה ימים לעומר, שהם שבוע אחד ושלושה ימים",t[11]="היום אחד עשר יום לעומר, שהם שבוע אחד וארבעה ימים",t[12]="היום שנים עשר יום לעומר, שהם שבוע אחד וחמישה ימים",t[13]="היום שלושה עשר יום לעומר, שהם שבוע אחד ושישה ימים",t[14]="היום ארבעה עשר יום לעומר, שהם שני שבועות",t[15]="היום חמישה עשר יום לעומר, שהם שני שבועות ויום אחד",t[16]="היום שישה עשר יום לעומר, שהם שני שבועות ושני ימים",t[17]="היום שיבעה עשר יום לעומר, שהם שני שבועות ושלושה ימים",t[18]="היום שמונה עשר יום לעומר, שהם שני שבועות וארבעה ימים",t[19]="היום תישעה עשר יום לעומר, שהם שני שבועות וחמישה ימים",t[20]="היום עשרים יום לעומר, שהם שני שבועות ושישה ימים",t[21]="היום אחד ועשרים יום לעומר, שהם שלושה שבועות",t[22]="היום שנים ועשרים יום לעומר, שהם שלושה שבועות ויום אחד",t[23]="היום שלושה ועשרים יום לעומר, שהם שלושה שבועות ושני ימים",t[24]="היום ארבעה ועשרים יום לעומר, שהם שלושה שבועות ושלושה ימים",t[25]="היום חמישה ועשרים יום לעומר, שהם שלושה שבועות וארבעה ימים",t[26]="היום שישה ועשרים יום לעומר, שהם שלושה שבועות וחמישה ימים",t[27]="היום שיבעה ועשרים יום לעומר, שהם שלושה שבועות ושישה ימים",t[28]="היום שמונה ועשרים יום לעומר, שהם ארבעה שבועות",t[29]="היום תישעה ועשרים יום לעומר, שהם ארבעה שבועות ויום אחד",t[30]="היום שלושים יום לעומר, שהם ארבעה שבועות ושני ימים",t[31]="היום אחד ושלושים יום לעומר, שהם ארבעה שבועות ושלושה ימים",t[32]="היום שנים ושלושים יום לעומר, שהם ארבעה שבועות וארבעה ימים",t[33]="היום שלושה ושלושים יום לעומר, שהם ארבעה שבועות וחמישה ימים",t[34]="היום ארבעה ושלושים יום לעומר, שהם ארבעה שבועות ושישה ימים",t[35]="היום חמישה ושלושים יום לעומר, שהם חמישה שבועות",t[36]="היום שישה ושלושים יום לעומר, שהם חמישה שבועות ויום אחד",t[37]="היום שיבעה ושלושים יום לעומר, שהם חמישה שבועות ושני ימים",t[38]="היום שמונה ושלושים יום לעומר, שהם חמישה שבועות ושלושה ימים",t[39]="היום תישעה ושלושים יום לעומר, שהם חמישה שבועות וארבעה ימים",t[40]="היום ארבעים יום לעומר, שהם חמישה שבועות וחמישה ימים",t[41]="היום אחד וארבעים יום לעומר, שהם חמישה שבועות ושישה ימים",t[42]="היום שנים וארבעים יום לעומר, שהם שישה שבועות",t[43]="היום שלושה וארבעים יום לעומר, שהם שישה שבועות ויום אחד",t[44]="היום ארבעה וארבעים יום לעומר, שהם שישה שבועות ושני ימים",t[45]="היום חמישה וארבעים יום לעומר, שהם שישה שבועות ושלושה ימים",t[46]="היום שישה וארבעים יום לעומר, שהם שישה שבועות וארבעה ימים",t[47]="היום שיבעה וארבעים יום לעומר, שהם שישה שבועות וחמישה ימים",t[48]="היום שמונה וארבעים יום לעומר, שהם שישה שבועות ושישה ימים",t[49]="היום תישעה וארבעים יום לעומר, שהם שיבעה שבועות",t[n]}return null}